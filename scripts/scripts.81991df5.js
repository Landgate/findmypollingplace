"use strict";var module=angular.module("appApp",["ngMaterial","ngAnimate","ngCookies","ngResource","ngRoute","ngSanitize","ngTouch"]);module.service("GMESchoolLookup",["$http",function(a){this.run=function(b,c){return a.get("https://www.googleapis.com/mapsengine/v1/tables/09372590152434720789-04451421473390432748/features",{params:{limit:1,orderBy:"distance",select:"gx_id,SchoolName,geometry,ST_DISTANCE(geometry,ST_POINT("+c+", "+b+")) as distance",version:"published",where:"ST_DISTANCE(geometry,ST_POINT("+c+", "+b+")) <= 10000",key:"AIzaSyDB3manTIJORPPJL06pKafXmO_KxPPKysE"}})}}]),module.service("GMEElectorateLookup",["$http",function(a){this.run=function(b,c){return a.get("https://www.googleapis.com/mapsengine/v1/tables/09372590152434720789-08311873295286629979/features",{params:{limit:1,select:"gx_id,name",version:"published",intersects:"POINT("+c+" "+b+")",where:"usage_code = 160",key:"AIzaSyBwJeh9BuryySBldL5Co1A2NF74hr1zn_I"}})}}]),module.controller("AppCtrl",["$scope",function(){}]),module.controller("LeftCtrl",["$scope","$http","GMESchoolLookup","GMEElectorateLookup",function(a,b,c,d){a.data={querying:!1,queried:!1,school:"",electorate:"",show_warning:!1};var e=document.querySelector("google-map");e.addEventListener("google-map-ready",function(){a.gPlace=new google.maps.places.Autocomplete(document.getElementById("address_search"),{bounds:new google.maps.LatLngBounds(new google.maps.LatLng(-35,114),new google.maps.LatLng(-12,129))}),google.maps.event.addListener(a.gPlace,"place_changed",function(){a.$apply(function(){var b=a.gPlace.getPlace();b&&b.formatted_address&&a.choose(b)})})}),a.choose=function(b){a.data.querying=!0,a.searchToken=b.formatted_address;new google.maps.Marker({map:e.map,position:b.geometry.location});c.run(b.geometry.location.lat(),b.geometry.location.lng()).then(function(c){var f=c.data.features[0];a.data.school=f.properties.SchoolName;var g=new google.maps.Marker({position:new google.maps.LatLng(f.geometry.coordinates[1],f.geometry.coordinates[0]),map:e.map,title:f.properties.SchoolName}),h=new google.maps.LatLngBounds;return h.extend(b.geometry.location),h.extend(g.getPosition()),e.map.fitBounds(h),d.run(f.geometry.coordinates[1],f.geometry.coordinates[0])}).then(function(c){var e=c.data.features[0];return a.data.electorate=e.properties.name,d.run(b.geometry.location.lat(),b.geometry.location.lng())}).then(function(b){a.data.electorate==b.data.features[0].properties.name&&(a.data.show_warning=!1),a.data.querying=!1,a.data.queried=!0})}}]),module.controller("MapCtrl",["$scope",function(){}]);